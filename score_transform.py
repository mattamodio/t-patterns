import sys
import MySQLdb

filename = 'sat.txt'
table = 'claim_events_simple'


conn = MySQLdb.connect( host='127.0.0.1', user='root', db='amfam', charset='utf8')
conn.autocommit(True)

cursor = conn.cursor()

claim_numbers = [270,635,1105,1495,1585,2233,2360,2394,2429,2430,2720,2968,2969,3130,3307,3673,3683,3807,4099,4166,4302,4522,4596,4664,5517,5665,5681,5940,6532,6659,6666,6906,7352,7503,7628,7912,8083,9151,9262,11157,11335,11482,11491,11611,11703,11936,11955,12492,12752,13235,13365,13500,13589,13953,14359,14392,14541,14673,14716,14938,15239,15551,15592,15931,16128,16396,16599,16750,16915,16917,17506,18251,18451,18919,20739,21075,21381,21703,21907,22473,22542,23106,23112,24345,24447,24511,26073,26452,26759,27191,27364,27422,27632,28048,28398,28720,29285,29312,29757,30084,30161,30892,31272,31442,31911,32359,32739,32824,32906,33111,33530,33601,33670,33887,34527,34956,35076,35445,36925,37143,37296,37538,37968,38046,38577,38645,39323,40528,40634,40840,40951,43226,43287,43289,43341,43819,44307,44315,45594,45654,46012,46033,46060,46735,47418,47637,47755,47949,48088,48369,48653,49342,49529,49533,49643,49703,50200,50313,50361,51313,51407,51800,52450,52452,52503,52658,52725,52794,53115,53457,53628,54740,55098,55118,55121,56114,56342,57671,57774,57790,57842,58395,58473,58476,58703,58971,59146,59164,60609,60731,61042,61372,61738,61772,61892,61954,62080,62384,62390,62567,62766,63263,63679,64300,64812,65398,65783,66015,67115,67122,67359,67449,67769,68097,68107,68631,69857,69892,70780,70849,70916,71133,71457,72169,72176,72533,72773,73159,73164,73482,73801,74233,74240,74369,74431,74773,74954,75252,75409,75679,75857,75878,76051,76122,76523,76555,77142,77157,77470,77906,78891,79135,79248,79370,79550,79596,79863,79869,79909,80539,80820,80865,80881,81548,81832,81896,82107,82606,82837,83192,83438,83713,83846,84152,84381,84472,84840,85183,85655,85698,85734,85940,86121,86736,86792,86802,87990,88055,88457,88787,88906,89057,89061,90239,90740,90776,91035,91039,91248,91551,91687,92686,92980,92987,92989,93009,93030,93066,93326,93331,93389,94342,94368,94598,94751,95368,95734,96223,96306,96947,97004,97286,97356,97507,97707,97832,97973,98026,98340,99060,99929,100003,100482,100629,100682,101862,102526,102539,102981,103361,103887,104027,104060,104364,104424,104546,104751,104764,105422,105630,106298,106352,106392,106545,106700,107401,107415,108110,108134,109302,110064,110139,110331,111073,111526,111564,112070,112071,112083,112493,112897,112901,113178,113840,114193,114424,114503,114830,115194,115516,116126,116153,117125,117127,117130,117473,117541,117787,117804,117856,118162,118491,118637,119050,119485,119653,119879,120166,120201,121764,121812,121878,121886,122147,122404,123059,123122,123275,123915,124611,125059,125102,125284,125540,125911,126205,126218,126892,126929,127254,127586,127940,127979,128151,128282,128294,128323,128895,129179,129281,129357,129993,130136,130269,131789,132172,132424,132750,133261,133740,133744,133822,133849,133924,133958,134206,134398,136059,136159,136284,136297,136464,136468,136514,136577,136725,136742,136882,136917,137321,137713,137914,138092,138467,138540,138697,138713,138974,140170,140697,140999,141518,141689,141791,141858,141956,142192,142290,142452,142640,143605,143638,143965,144405,144722,145066,145363,145718,145804,146442,146736,146900,147067,147404,147453,147544,147565,148155,148370,148698,149443,149661,149697,149800,150068,150284,150307,151569,151744,152573,152606,153239,153299,153327,153411,153572,153928,154465,154924,156156,156463,156986,157354,157436,157442,157848,157979,158569,158927,159071,159106,159351,159763,160089,160253,160387,160452,160755,160863,161304,161426,161463,162131,162513,162710,163234,163238,163410,163427,163489,163727,163764,164086,164094,164190,164438,164897,164905,164987,165202,165505,165785,166500,166670,166697,166806,166816,166829,166898,167616,167775,168185,168606,168615,169947]


with open(filename) as f:
	for line in f:
		line = line.strip().split(' ')
		score = (int(line[0]), int(float(line[1])))

		if score[0] in claim_numbers:
			INSERT_STRING = 'UPDATE {0} SET happiness={1} WHERE claimnumber={2}'.format(table, score[1], score[0])
			cursor.execute(INSERT_STRING)
			#sys.exit()
